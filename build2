#include<iostream>
#include<fstream>
#include<sstream>
#include<string>
using namespace std;
struct userdata {
	string username;
	string password;
	string allids[100];
};
struct hallplace {
	int floor;
	int room;
};
struct hall {
	string name;
	hallplace place;
	int numberofseats;
	string events_shows[100];
};
struct date {
	int day;
	int year;
	int month;
};
struct events {
	string name;
	string evinhall;
	string id;
	date startdate;
	date enddate;
	string time;
};
struct shows {
	string name;
	string showinhall;
	string id;
	date startdate;
	date enddate;
	string time;
	int showseats;
};
struct currentusers {
	string username;
	string password;
	string reservationid[100];
	string eventid[100];
	string showid[100];
};

currentusers user;
hall halldata[100];
events eventdata[100];
shows showdata[100];
userdata users[100];
bool admin = false;

void menu_admin();
void menu_user();
void main_menu();
void retrive_data()
{
	//start of getting user data from file
	int usernameindx = 0;
	int paasswordindx = 1;
	string temp[1000];
	ifstream getuserdata;
	getuserdata.open("userdata.txt");
	if (getuserdata.fail()) {
		cout << "error" << endl;
	}
	else {
		for (int i = 0; i < 1000; i++)
		{
			getline(getuserdata, temp[i]);
		}
		for (int i = 0; !temp[i].empty(); i++)
		{
			users[i].username = temp[usernameindx];
			users[i].password = temp[paasswordindx];
			usernameindx += 2;
			paasswordindx += 2;

		}

	}
	getuserdata.close();
	//end of getting userdata from file
	//---------------------------------------------------------------------------------
	//start of getting all halls data without events
	int nameindx = 0;
	int floorindx = 1;
	int roomindx = 2;
	int seatsindx = 3;
	string temp1[1000];
	ifstream gethalldata;
	gethalldata.open("halldata.txt");
	if (gethalldata.fail())
	{
		cout << "error" << endl;
	}
	else
	{
		for (int i = 0; i < 1000; i++)
		{
			getline(gethalldata, temp1[i]);
		}

		for (int i = 0; !temp1[i].empty(); i++)
		{
			halldata[i].name = temp1[nameindx];

			stringstream floor_to_int(temp1[floorindx]);
			floor_to_int >> halldata[i].place.floor;

			stringstream room_to_int(temp1[roomindx]);
			room_to_int >> halldata[i].place.room;

			stringstream seats_to_int(temp1[seatsindx]);
			seats_to_int >> halldata[i].numberofseats;

			nameindx += 4;
			floorindx += 4;
			roomindx += 4;
			seatsindx += 4;


		}
	}
	gethalldata.close();
	//end hall data
	//-----------------------------------------
	//start event data retrive
	int name = 0;
	int evinhallindx = 1;
	int idindx = 2;
	int dayindx = 3;
	int monthindx = 4;
	int yearindx = 5;
	int day1indx = 6;
	int month1indx = 7;
	int year1indx = 8;
	int stime = 9;
	string tempev[1000];
	ifstream geteventdata;
	geteventdata.open("eventdata.txt");
	if (geteventdata.fail())
	{
		cout << "error" << endl;
	}
	else
	{
		for (int i = 0; i < 1000; i++)
		{
			getline(geteventdata, tempev[i]);
		}
		for (int i = 0; !tempev[i].empty(); i++)
		{

			eventdata[i].name = tempev[name];
			eventdata[i].evinhall = tempev[evinhallindx];
			eventdata[i].id = tempev[idindx];

			stringstream day_to_int(tempev[dayindx]);
			day_to_int >> eventdata[i].startdate.day;
			stringstream month_to_int(tempev[monthindx]);
			month_to_int >> eventdata[i].startdate.month;
			stringstream year_to_int(tempev[yearindx]);
			year_to_int >> eventdata[i].startdate.year;

			stringstream eday_to_int(tempev[day1indx]);
			eday_to_int >> eventdata[i].enddate.day;
			stringstream emonth_to_int(tempev[month1indx]);
			emonth_to_int >> eventdata[i].enddate.month;
			stringstream eyear_to_int(tempev[year1indx]);
			eyear_to_int >> eventdata[i].enddate.year;

			eventdata[i].time = tempev[stime];

			name += 10;
			evinhallindx += 10;
			idindx += 10;
			dayindx += 10;
			monthindx += 10;
			yearindx += 10;
			day1indx += 10;
			month1indx += 10;
			year1indx += 10;
			stime += 10;



		}
	}
	geteventdata.close();
	//end event data 
	//-----------------------------
	//start shows data
	int nameindex = 0;
	int showinhallindex = 1;
	int idindex = 2;
	int dayindex = 3;
	int monthindex = 4;
	int yearindex = 5;
	int day1index = 6;
	int month1index = 7;
	int year1index = 8;
	int stime1 = 9;
	int seats = 10;
	string tempshow[1100];
	ifstream getshowdata;
	getshowdata.open("showdata.txt");
	if (getshowdata.fail())
	{
		cout << "error" << endl;
	}
	else
	{
		for (int i = 0; i < 1000; i++)
		{
			getline(getshowdata, tempshow[i]);
		}
		for (int i = 0; !tempshow[i].empty(); i++)
		{


			showdata[i].name = tempshow[nameindex];
			showdata[i].showinhall = tempshow[showinhallindex];
			showdata[i].id = tempshow[idindex];

			stringstream day1_to_int(tempshow[dayindex]);
			day1_to_int >> showdata[i].startdate.day;
			stringstream month1_to_int(tempshow[monthindex]);
			month1_to_int >> showdata[i].startdate.month;
			stringstream year1_to_int(tempshow[yearindex]);
			year1_to_int >> showdata[i].startdate.year;

			stringstream eday1_to_int(tempshow[day1index]);
			eday1_to_int >> showdata[i].enddate.day;
			stringstream emonth1_to_int(tempshow[month1index]);
			emonth1_to_int >> showdata[i].enddate.month;
			stringstream eyear1_to_int(tempshow[year1index]);
			eyear1_to_int >> showdata[i].enddate.year;

			showdata[i].time = tempshow[stime1];
			stringstream seats_to_int(tempshow[seats]);
			seats_to_int >> showdata[i].showseats;

			nameindex += 11;
			showinhallindex += 11;
			idindex += 11;
			dayindex += 11;
			monthindex += 11;
			yearindex += 11;
			day1index += 11;
			month1index += 11;
			year1index += 11;
			stime1 += 11;
			seats += 11;

		}
	}
	getshowdata.close();
	//end show data
	//------------------------------------------------
	//start user reserved event's id
	ifstream getreseventid;
	string idinfile[100];
	int cntt = 0;
	for (int i = 0; !users[i].username.empty(); i++)
	{
		string userfile;
		userfile = users[i].username + ".txt";
		getreseventid.open(userfile.c_str());
		if (getreseventid.fail())
		{
			cout << "error" << endl;
		}
		else
		{
			for (int j = 0; !getreseventid.eof(); j++)
			{
				getline(getreseventid, idinfile[j]);
			}
		}
		for (int j = 0; !idinfile[j].empty(); j++)
		{

			users[i].allids[j] = idinfile[j];

		}
		getreseventid.close();
	}
	//end user reserved event's id
	//---------------------------------------
	//start hall reserved event's name
	ifstream geteventinhall;
	string eventinhall[100];
	for (int i = 0; !halldata[i].name.empty(); i++)
	{

		string hallfile;
		hallfile = halldata[i].name + ".txt";
		geteventinhall.open(hallfile.c_str());
		if (geteventinhall.fail())
		{
			cout << "error" << endl;
		}
		else
		{
			for (int j = 0; !geteventinhall.eof(); j++)
			{
				getline(geteventinhall, eventinhall[j]);
			}
		}
		for (int j = 0; !eventinhall[j].empty(); j++)
		{
			halldata[i].events_shows[j] = eventinhall[j];
		}
		geteventinhall.close();

	}

}
void save_data() {
	//remove files
	remove("eventdata.txt");
	remove("userdata.txt");
	remove("halldata.txt");
	remove("showdata.txt");
	for (int i = 0; !users[i].username.empty(); i++)
	{
		string userremove = users[i].username + ".txt";
		remove(userremove.c_str());
	}
	for (int i = 0; !halldata[i].name.empty(); i++)
	{
		string hallremove = halldata[i].name + ".txt";
		remove(hallremove.c_str());
	}
	//create new user files
	ofstream newuserdata;
	newuserdata.open("userdata.txt");
	for (int i = 0; !users[i].username.empty(); i++)
	{

		newuserdata << users[i].username << endl;
		newuserdata << users[i].password << endl;
	}
	newuserdata.close();
	//create userfiles
	ofstream newusersid;
	for (int i = 0; !users[i].username.empty(); i++)
	{
		string userfiles = users[i].username + ".txt";
		newusersid.open(userfiles.c_str());
		for (int j = 0; !users[i].allids[j].empty(); j++)
		{
			newuserdata << users[i].allids[j] << endl;
		}
		newusersid.close();
	}
	//create hall files
	ofstream newhalldata;
	newhalldata.open("halldata.txt");
	for (int i = 0; !halldata[i].name.empty(); i++)
	{
		newhalldata << halldata[i].name << endl;
		newhalldata << halldata[i].place.floor << endl;
		newhalldata << halldata[i].place.room << endl;
		newhalldata << halldata[i].numberofseats << endl;
	}
	newhalldata.close();
	//create hall files
	ofstream newhallev;
	for (int i = 0; !halldata[i].name.empty(); i++)
	{
		string hallfiles = halldata[i].name + ".txt";
		newhallev.open(hallfiles.c_str());
		for (int j = 0; !halldata[i].events_shows[j].empty(); j++)
		{
			newhallev << halldata[i].events_shows[j] << endl;
		}
		newhallev.close();
	}
	//create eventdata
	ofstream neweventdata;
	neweventdata.open("eventdata.txt");
	for (int i = 0; !eventdata[i].name.empty(); i++)
	{
		neweventdata << eventdata[i].name << endl;
		neweventdata << eventdata[i].evinhall << endl;
		neweventdata << eventdata[i].id << endl;
		neweventdata << eventdata[i].startdate.day << endl;
		neweventdata << eventdata[i].startdate.month << endl;
		neweventdata << eventdata[i].startdate.year << endl;
		neweventdata << eventdata[i].enddate.day << endl;
		neweventdata << eventdata[i].enddate.month << endl;
		neweventdata << eventdata[i].enddate.year << endl;
		neweventdata << eventdata[i].time << endl;
	}
	neweventdata.close();
	//create new showdata
	ofstream newshowdata;
	newshowdata.open("showdata.txt");
	for (int i = 0; !showdata[i].name.empty(); i++)
	{
		newshowdata << showdata[i].name << endl;
		newshowdata << showdata[i].showinhall << endl;
		newshowdata << showdata[i].id << endl;
		newshowdata << showdata[i].startdate.day << endl;
		newshowdata << showdata[i].startdate.month << endl;
		newshowdata << showdata[i].startdate.year << endl;
		newshowdata << showdata[i].enddate.day << endl;
		newshowdata << showdata[i].enddate.month << endl;
		newshowdata << showdata[i].enddate.year << endl;
		newshowdata << showdata[i].time << endl;
		newshowdata << showdata[i].showseats << endl;
	}
	newshowdata.close();
}
void sort_id()
{
	int eventidindx = 0;
	for (int k = 0; !user.reservationid[k].empty(); k++)
	{
		for (int l = 0; l < 100; l++)
		{
			if (user.reservationid[k] == eventdata[l].id)
			{
				user.eventid[eventidindx] = user.reservationid[k];
				eventidindx++;
			}
		}
	}
	int showidindx = 0;
	for (int k = 0; !user.reservationid[k].empty(); k++)
	{
		for (int l = 0; l < 100; l++)
		{
			if (user.reservationid[k] == showdata[l].id)
			{
				user.showid[showidindx] = user.reservationid[k];
				showidindx++;
			}
		}
	}
}
void login()
{
	system("cls");
	cin.ignore();
	int cntusers = 0;
	string tempname;
	string temppassword;
	for (int i = 0; !users[i].username.empty(); i++)
	{
		cntusers++;
	}
	cout << "Enter username : ";
	getline(cin, tempname);
	for (int i = 0; i < cntusers; i++)
	{
		if (users[i].username == tempname)
		{
			cout << "Enter password : ";
			getline(cin, temppassword);
			if (users[i].password == temppassword)
			{
				cout << "login succesful." << endl;
				user.username = tempname;
				user.password = temppassword;
				for (int j = 0; !users[i].allids[j].empty(); j++)
				{

					user.reservationid[j] = users[i].allids[j];

				}
			}
		}
	}
	if (user.username.empty())
	{
		cout << "Wrong username or password,Please try again." << endl;
		login();
	}
	if (tempname == "admin") {
		admin = true;
	}
	system("pause");
	sort_id();
	if (admin) {
		menu_admin();
	}
	else
	{
		menu_user();
	}
}
void registerme() {
	system("cls");
		//check no. of users
		int cntusers = 0;
		string tempusername;
		string temppassword, tempconfirm;
		for (int i = 0; !users[i].username.empty(); i++)
		{
				cntusers++;
		}
		//enter username
		cin.ignore();
		cout << "Enter username : ";
		getline(cin, tempusername);
		//check for username to avoid duplications
		for (int i = 0; !users[i].username.empty(); i++)
		{
				if (users[i].username == tempusername)
				{
					cout << "Username exsists,try again." << endl;
					system("pause");
					registerme();
				}
		}
		//enter password where 4<pass<17
		cout << "enetr password : ";
		getline(cin, temppassword);
		if (temppassword.size() > 17) {
			cout << "password limit exceded."<<endl;
			registerme();
		}
		else if (temppassword.size() < 4) {
			cout << "password length too small."<<endl;
			registerme();
		}
		else
		{
			//confirm password
			cout << "confirm password : ";
			getline(cin, tempconfirm);
			if (temppassword == tempconfirm)
			{
				cout << "user registered sucessfuly." << endl;
				cout << "username : " << tempusername << endl;
				cout << "password : " << temppassword << endl;
				//put in struct after last user
				users[cntusers].username = tempusername;
				users[cntusers].password = temppassword;
			}
		}
		system("pause");
		main_menu();
	}
void Exit() {
	system("cls");
	save_data();
		cout << "Thank you for using hall reservation system" << endl;
		cout << "Have a nice day." << endl;
		system("pause");
		exit(0);
}
void addnewhall()
{
	system("cls");
	cin.ignore();
	int hallcnt = 0;
	int room = 0;
	int floor = 0;
	int seatsno = 0;
	string newhall;
	//loop el cnt to get size
	for (int j = 0; !halldata[j].name.empty(); j++)
	{
		hallcnt++;
	}
	cout << "Enter hall's name : ";

	for (int i = 0; !halldata[i].name.empty(); i++)
	{
		while (newhall.length() == 0)
		{                               //keep reading a new line when there is a blank line
			getline(cin, newhall);
		}
		if (halldata[i].name == newhall)
		{
			cout << "Sorry , Hall's name already exsist,try again" << endl;
			system("pause");
			addnewhall();
		}
	}
	cout << "Enter the place" << endl << "Floor : ";
	cin >> floor;
	if (floor <= 0)
	{
		cout << "error.Retry" << endl;
		system("pause");
		addnewhall();
	}
	cout << endl << "Room : ";
	cin >> room;
	if (room <= 0)
	{
		cout << "Invalid data type.Retry" << endl;
		system("pause");
		addnewhall();
	}
	for (int k = 0; k < hallcnt; k++)
	{
		if (halldata[k].place.room == room)
		{
			cout << "Sorry , this room is already reserved ,try again" << endl;
			cout << "Room : ";
			cin >> room;
		}
	}
	//endloop
	cout << "Enter number of seat (max 100) : ";
	cin >> seatsno;
	if (seatsno > 100)
	{
		cout << "error max seats=100" << endl;
		cout << "Enter number of seat (max 100) : ";
		cin >> seatsno;
	}
	halldata[hallcnt].name = newhall;
	halldata[hallcnt].place.floor = floor;
	halldata[hallcnt].place.room = room;
	halldata[hallcnt].numberofseats = seatsno;
	cout << endl << "Addition done" << endl;
	cout << "*********************" << endl;
	cout << "data after addition" << endl;
	cout << "Name : " << halldata[hallcnt].name << endl;
	cout << "Place : " << endl << "Floor : " << halldata[hallcnt].place.floor << endl;
	cout << "Room : " << halldata[hallcnt].place.room << endl;
	cout << "N of seats : " << halldata[hallcnt].numberofseats << endl;
	cout << "*************" << endl;
	system("pause");
	menu_admin();
}
void removehall()
{
	system("cls");
	int hallcnt = 0;
	int evshiftindex = 0;
	int idshiftindex = 0;
	string evremid;
	string shremid;
	for (int j = 0; !halldata[j].name.empty(); j++)
	{
		hallcnt++;
	}
	int removalindex;
	for (int g = 0; g < hallcnt; g++)
	{
		cout << g + 1 << '.' << halldata[g].name << endl;
	}
	cout << "Choose number of the hall to be removed : " << endl;
	cin >> removalindex;
	for (int r = 0; !eventdata[r].name.empty(); r++)
	{
		if (eventdata[r].evinhall == halldata[removalindex - 1].name)
		{
			evremid = eventdata[r].id;
			evshiftindex = r;
			for (int s = evshiftindex; !eventdata[s].name.empty(); s++)
			{
				eventdata[s].name = eventdata[s + 1].name;
				eventdata[s].evinhall = eventdata[s + 1].evinhall;
				eventdata[s].id = eventdata[s + 1].id;
				eventdata[s].startdate = eventdata[s + 1].startdate;
				eventdata[s].time = eventdata[s + 1].time;
			}
		}
	}
	for (int a = 0; !showdata[a].name.empty(); a++)
	{
		if (showdata[a].showinhall == halldata[removalindex - 1].name) //nafs elesm
		{
			shremid = showdata[a].id;
			for (int m = a; !eventdata[m].name.empty(); m++)
			{
				showdata[m].name = showdata[m + 1].name;
				showdata[m].showinhall = showdata[m + 1].showinhall;
				showdata[m].id = showdata[m + 1].id;
				showdata[m].startdate = showdata[m + 1].startdate;
				showdata[m].enddate = showdata[m + 1].enddate;
				showdata[m].time = showdata[m + 1].time;
				showdata[m].showseats = showdata[m + 1].showseats;
			}
		}
	}
	for (int q = 0; !users[q].username.empty(); q++)
	{
		for (int y = 0; !users[q].allids[y].empty(); y++)
		{
			if (evremid == users[q].allids[y])
			{

				for (int k = y; !users[q].allids[k].empty(); k++)
				{
					users[q].allids[k] = users[q].allids[k + 1];
				}
			}
			if (shremid == users[q].allids[y])
			{

				for (int k = y; !users[q].allids[k].empty(); k++)
				{
					users[q].allids[k] = users[q].allids[k + 1];
				}
			}

		}
	}
	for (int j = removalindex - 1; !halldata[j].name.empty(); j++)
	{
		halldata[j].name = halldata[j + 1].name;
		halldata[j].place.floor = halldata[j + 1].place.floor;
		halldata[j].place.room = halldata[j + 1].place.room;
		halldata[j].numberofseats = halldata[j + 1].numberofseats;
	}
	system("pause");
}
void upcomingevents()
{
	system("cls");
	int cnt = 0;
	int eventcnt = 0;
	int year = 0;
	int month = 0;
	int day = 0;
	for (int i = 0; !eventdata[i].name.empty(); i++)
	{
		eventcnt++;

	}
	cout << "Please enter date : ";
	cin >> day >> month >> year;
	cout << "upcoming events are : " << endl;
	for (int i = 0; i < eventcnt; i++)
	{
		if (eventdata[i].startdate.day >= day && eventdata[i].startdate.month >= month && eventdata[i].startdate.year >= year)
		{
			cout << "event name : " << eventdata[i].name << endl;
			cout << "event id : " << eventdata[i].id << endl;
			cout << "happining in hall : " << eventdata[i].evinhall << endl;
			cout << "event start date is : " << eventdata[i].startdate.day << "/" << eventdata[i].startdate.month << "/" << eventdata[i].startdate.year << endl;;
			cout << "event end date is : " << eventdata[i].enddate.day << "/" << eventdata[i].enddate.month << "/" << eventdata[i].enddate.year << endl;
			cout << "event duration is : from " << eventdata[i].time << endl;
			cout << "************************" << endl;
			cnt++;
		}
	}
		if(cnt<1)
		{
			cout << "no events found.";
			system("pause");
			menu_user();
		}

	system("pause");
	menu_user();
}
void showreservation()
{
	system("cls");
	int showcnt = 0;
	bool checkshows = false;
	for (int j = 0; !showdata[j].name.empty(); j++)
	{
		showcnt++;
	}
	cout << "Select the show you want to reserve : " << endl;
	int index = 1;
	for (int i = 0; i < showcnt; i++)
	{
		if (showdata[i].showseats <= 100)
		{
			cout << index << '.';
			cout << showdata[i].name << endl;
			index++;
		}
	}
	int choice;
	cin >> choice;
	if (cin.fail())
	{
		cout << "Error!Retry." << endl;
		cin.clear();
		cin.ignore();
		showreservation();
	}
	else
	{
		if (choice <= index && choice > 0)
		{
			for (int h = 0; h < showcnt; h++)
			{
				if (user.showid[h] == showdata[choice - 1].id)
				{
					cout << "Already reserved." << endl;
					checkshows = true;
					break;
				}

			}
			if (checkshows == false)
			{
				user.showid[showcnt - 1] = showdata[choice - 1].id;
				cout << "Reservation done successfully!" << endl;

			}
		}
		else
		{
			cout << "Error!Retry." << endl;
			showreservation();
		}
	}
	system("pause");
}
void eventreservation()
{
	system("cls");
	bool checkevents = false;
	int eventcnt = 0;
	for (int j = 0; !eventdata[j].name.empty(); j++)
	{
		eventcnt++;
	}
	cout << "Select the event you want to reserve : " << endl;
	int index = 1;
	for (int i = 0; i < eventcnt; i++)
	{
		cout << index << '.';
		index++;
		cout << eventdata[i].name << endl;
	}
	int choice;
	cin >> choice;
	if (cin.fail())
	{
		cout << "Error!Retry." << endl;
		cin.clear();
		cin.ignore();
		eventreservation();
	}
	else
	{
		if (choice <= index && choice > 0)

		{
			for (int h = 0; h < eventcnt; h++)
			{
				if (user.eventid[h] == eventdata[choice - 1].id)
				{
					cout << "Already reserved." << endl;
					checkevents = true;
					break;
				}

			}
			if (checkevents == false)
			{
				user.eventid[eventcnt - 1] = eventdata[choice - 1].id;
				cout << "Reservation done successfully!" << endl;

			}
		}
		else
		{
			cout << "Error!Retry." << endl;
			eventreservation();

		}
	}
}
void canceleventreservation()
	{
	system("cls");
		int count1 = 0, count2 = 0;               // the actual elements of array
		for (int i = 0; !user.eventid[i].empty(); i++)     // identifay the eventid  of user
		{
			count1++;
		}
		for (int j = 0; !eventdata[j].id.empty(); j++)       // identifay  the eventid of events 
		{

			count2++;
		}
		for (int i = 0; i < count1; i++)
		{
			for (int j = 0; j < count2; j++)
			{
				if (user.eventid[i] == eventdata[j].id)
				{
					cout << i + 1 << "." << eventdata[j].name << endl;
				}
			}
		}
		cout << " Select the event you want to cancel " << endl;
		int choice;
		cin >> choice;

		for (int i = choice - 1; !user.eventid[i].empty(); i++)
		{
			user.eventid[i] = user.eventid[i + 1];
		}
		cout << "cancel succes" << endl;
		cout << "current reserved events : " << endl;
		for (int i = 0; i < count1; i++)
		{
			for (int j = 0; j < count2; j++)
			{
				if (user.eventid[i] == eventdata[j].id)
				{
					cout << i + 1 << "." << eventdata[j].name << endl;
					break;
				}
			}
		}
		system("pause");
		menu_user();
}
void cancelshowreservation() {
	system("cls");
		int counter1 = 0, counter2 = 0;    // the actual  array elemnts 
		for (int i = 0; !user.showid[i].empty(); i++)
		{
			counter1++;
		}
		for (int j = 0; !showdata[j].id.empty(); j++)      // the actual elements of  show id 
		{
			counter2++;
		}
		for (int i = 0; i < counter1; i++)               // show the reserved shows 
		{
			for (int j = 0; j < counter2; j++)
			{
				if (user.showid[i] == showdata[j].id)
				{
					cout << i + 1 << "." << showdata[j].name << endl;
					break;
				}
			}
		}
		cout << " Select the show you want to cancel " << endl;
		int choice;
		cin >> choice;
		for (int j = 0; !user.showid[j].empty(); j++)                 // increase num  of show seat 
		{
			if (user.showid[choice - 1] == showdata[j].id)
			{
				showdata[j].showseats++;
			}
		}
		for (int i = choice - 1; !user.showid[i].empty(); i++)     //  del the showid 
		{
			user.showid[i] = user.showid[i + 1];
		}
		cout << "show canceled" << endl;
		cout << "current reserved shows : " << endl;
		for (int i = 0; i < counter1; i++)               // show the reserved shows 
		{
			for (int j = 0; j < counter2; j++)
			{
				if (user.showid[i] == showdata[j].id)
				{
					cout << i + 1 << "." << showdata[j].name << endl;
					break;
				}
			}
		}
		system("pause");
		menu_user();
	}
void searchshowhall() {
	system("cls");
		string showhall;
		bool notfound = true;
		cout << " Enter the show name :";
		getline(cin, showhall);

		for (int i = 0; !showdata[i].name.empty(); i++)
		{
			if (showhall == showdata[i].name)
			{
				cout << "The show at :" << showdata[i].showinhall << endl;
				notfound = false;
				break;
			}
		}

		if (notfound)
		{
			cout << "show not found." << endl;
			searchshowhall();
		}
		system("pause");
		
		menu_user();
}
void searcheventhall()
{
	system("cls");
		string eventhall;
		bool nfound = true;
		cout << " Enter the event name : ";
		getline(cin, eventhall);
		for (int i = 0; !eventdata[i].name.empty(); i++)
		{
			if (eventhall == eventdata[i].name)
			{
				cout << "The event at :" << eventdata[i].evinhall << endl;
				nfound = false;
				break;
			}
		}
		if (nfound)
		{
			cout << "event not found,please retry" << endl;
			searcheventhall();
		}
		system("pause");
		menu_user();
}
void searchbyhall()
{
	system("cls");
	cin.ignore();
	string hallname;
	bool found = false;
	cout << "Enter hall name :";
	getline(cin, hallname);
	for (int i = 0;!halldata[i].name.empty(); i++)
	{
		if (hallname == halldata[i].name)
		{
			cout << "hall name :" << halldata[i].name << endl;
			cout << "floor :" << halldata[i].place.floor << endl;
			cout << "room :" << halldata[i].place.room << endl;
			cout << "Number of seats :" << halldata[i].numberofseats << endl;
			cout << "list of events and shows :" << endl;
			for (int j = 0; !halldata[i].events_shows[j].empty(); j++)
			{
				cout << halldata[i].events_shows[j] << endl;
			}
			found = true;
		}
	}
	if (found==false)
	{
			cout << "Invalied Name!" << endl;
			system("pause");
			searchbyhall();
	}
	system("pause");
	menu_admin();
}
void timeline()
{
	system("cls");
	int showcnt = 0;
	for (int j = 0; !showdata[j].name.empty(); j++)
	{
		showcnt++;
	}
	int userday, usermonth, useryear;
	cout << "Enter required date(D/M/Y) :";
	cin >> userday >> usermonth >> useryear; //enter date that will be compared to shows' dates
//Loop to check if there was shows at that date
	for (int r = 0; r < 100; r++)
	{
		if (showdata[r].startdate.day == userday && showdata[r].startdate.month == usermonth && showdata[r].startdate.year == useryear)
		{
			cout << "* Available Shows *" << endl;
			break;
		}
		else
		{
			cout << "Sorry , no available shows." << endl;
			break;
		}
		//If date was found, display available shows details
	}
	for (int k = 0; k < showcnt; k++)
	{
		if (showdata[k].showseats < 100) //check no of seats
		{
			if (showdata[k].startdate.day == userday && showdata[k].startdate.month == usermonth && showdata[k].startdate.year == useryear)
			{
				cout << "Name :" << showdata[k].name << endl;
				cout << "Location : " << showdata[k].showinhall << endl;
				cout << "From " << showdata[k].time<<endl;
				cout << "-----------" << endl;

			}

		}
	}
	system("pause");
	menu_user();
}
int main() {
	retrive_data();
	main_menu();
	system("pause");
	return 0;
}
void main_menu() {
	system("cls");
	cout << "Welcome to hall reservation system, What would you like to do?" << endl<<endl;
	cout << "1.Login." << endl;
	cout << "2.Register." << endl;
	cout << "3.Exit." << endl;
	int choice;
	cin >> choice;
	switch (choice)
	{
	case 1:
		login();
		break;
	case 2:
		registerme();
		break;
	case 3:
		Exit();
		break;
	}
}
void menu_user() {
	system("cls");
	cout << "Welcome " << user.username << " ,What would you like to do?" << endl<<endl;
	cout << "1.Show all shows in a certain timeline." << endl;
	cout << "2.Show upcoming Events after a certain date." << endl;
	cout << "3.Create an Event." << endl;
	cout << "4.Create a Show." << endl;
	cout << "5.Reserve an Event." << endl;
	cout << "6.Reserve a Show." << endl;
	cout << "7.Cancel Event reservation." << endl;
	cout << "8.Cancel Show reservation." << endl;
	cout << "9.show event in which hall." << endl;
	cout << "10.show 'show' in which hall." << endl;
	cout << "11.logout." << endl;
	cout << "12.Exit" << endl;
	int choice;
	cin >> choice;
	switch (choice)
	{
	case 1:
		timeline();
		break;
	case 2:
		upcomingevents();
		break;
	case 3:

		break;
	case 4:

		break;
	case 5:
		eventreservation();
		break;
	case 6:
		showreservation();
		break;
	case 7:
		canceleventreservation();
		break;
	case 8:
		cancelshowreservation();
		break;
	case 9:
		searcheventhall();
		break;
	case 10:
		searchshowhall();
		break;
	case 11:
		main_menu();
		break;
	case 12:
		Exit();
	default:
		cout << "Error,Invalid choice." << endl;
		menu_user();
		break;
	}
}
void menu_admin()
{
	system("cls");
	cout << "Welcome Admin,What would you like to do?" << endl<<endl;
	cout << "1.Add a hall." << endl;
	cout << "2.Delete a hall." << endl;
	cout << "3.show data of a certain hall." << endl;
	cout << "4.Exit" << endl;
	int choice;
	cin >> choice;
	switch (choice)
	{
	case 1:
		addnewhall();
		break;
	case 2:
		removehall();
		break;
	case 3:
		searchbyhall();
	case 4:
		Exit();
	default:
		cout << "Error,invalid choice." << endl;
		menu_admin();
		break;
	}
}
